{'img_info': {'file_name': 'train/1523.jpg', 'width': 1024, 'height': 1024, 'license': 0, 'date_captured': '2020-12-22 17:18:16', 'id': 1523, 'filename': 'train/1523.jpg'}, 'ann_info': {'bboxes': array([[683.3, 394.4, 908.1, 441.9],
       [ 71.4, 384.8, 186.9, 455.9],
       [ 70.8, 388.3, 908.6, 916.3],
       [186.9, 302. , 628.8, 458.7],
       [621.4, 402. , 723.3, 448. ],
       [432.8, 734. , 536.8, 888.7],
       [465.6, 672.3, 556.4, 807.2]], dtype=float32), 'labels': array([0, 0, 1, 1, 1, 0, 0]), 'bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'masks': [None, None, None, None, None, None, None], 'seg_map': 'train/1523.png'}, 'img_prefix': '/opt/ml/detection/dataset/', 'seg_prefix': None, 'proposal_file': None, 'bbox_fields': ['gt_bboxes_ignore', 'gt_bboxes'], 'mask_fields': [], 'seg_fields': [], 'filename': '/opt/ml/detection/dataset/train/1523.jpg', 'ori_filename': 'train/1523.jpg', 'img': array([[[ 91, 119, 136],
        [ 92, 120, 137],
        [ 93, 121, 138],
        ...,
        [204, 194, 184],
        [204, 194, 184],
        [204, 194, 184]],
       [[ 87, 115, 132],
        [ 88, 116, 133],
        [ 91, 119, 136],
        ...,
        [204, 194, 184],
        [204, 194, 184],
        [204, 194, 184]],
       [[ 87, 115, 132],
        [ 88, 116, 133],
        [ 90, 118, 135],
        ...,
        [204, 194, 184],
        [204, 194, 184],
        [204, 194, 184]],
       ...,
       [[190, 192, 193],
        [190, 192, 193],
        [189, 191, 192],
        ...,
        [112,  95,  86],
        [147, 128, 120],
        [142, 125, 116]],
       [[191, 193, 194],
        [190, 192, 193],
        [189, 191, 192],
        ...,
        [ 46,  27,  19],
        [ 52,  31,  23],
        [ 49,  30,  22]],
       [[191, 193, 194],
        [190, 192, 193],
        [190, 192, 193],
        ...,
        [167, 146, 138],
        [132, 111, 103],
        [127, 106,  98]]], dtype=uint8), 'img_shape': (1024, 1024, 3), 'ori_shape': (1024, 1024, 3), 'img_fields': ['img'], 'gt_bboxes': array([[683.3, 394.4, 908.1, 441.9],
       [ 71.4, 384.8, 186.9, 455.9],
       [ 70.8, 388.3, 908.6, 916.3],
       [186.9, 302. , 628.8, 458.7],
       [621.4, 402. , 723.3, 448. ],
       [432.8, 734. , 536.8, 888.7],
       [465.6, 672.3, 556.4, 807.2]], dtype=float32), 'gt_bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'gt_labels': array([0, 0, 1, 1, 1, 0, 0])}
> /opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py(2038)_mosaic_transform()
-> assert 'mix_results' in results
(Pdb)
{'img_info': {'file_name': 'train/1997.jpg', 'width': 1024, 'height': 1024, 'license': 0, 'date_captured': '2020-12-28 12:03:00', 'id': 1997, 'filename': 'train/1997.jpg'}, 'ann_info': {'bboxes': array([[ 514. ,    0. ,  575.6,  151.9],
       [ 858.4,  232.4,  937.6,  266.4],
       [ 848.6,  127.7, 1023.7,  235.6],
       [ 601.1,  491.7,  844.2,  658.3],
       [ 785.6,    0. , 1023.7,  135.6],
       [ 697.9,   11.2,  786.3,   26.4],
       [ 695.2,    0. ,  802.9,   16.5],
       [ 464.6,  150.3,  904.8,  498.7],
       [ 450. ,    0. ,  963. ,  323.6],
       [ 536. ,   63.2,  885.1,  163. ],
       [ 574.6,   36.6,  779.8,   64.5],
       [ 898.7,  850.8,  994.5,  939.7],
       [ 866.5,  653. ,  968.4,  765. ],
       [   0. ,  484.6,  522.5,  849.6],
       [ 411.8,  574.5,  930.2,  965.4],
       [ 593.6,  676.8,  723.3,  833. ],
       [ 611.2,  702.2,  672.2,  832.5],
       [ 581.4,  737.5,  690.4,  829.4],
       [ 941.7,  870.3, 1023.6,  957.7],
       [ 194.7,  302. ,  403.3,  402.6],
       [ 557.4,   53.6,  845.6,  168.6],
       [ 614.9,  325.3,  651.1,  354.3],
       [ 627.8,  326.6,  738.9,  373.6],
       [ 729.7,  358.3,  856. ,  382.2],
       [ 775.8,  335.2,  836.4,  376.9],
       [ 736.5,  333.2,  785.9,  365.2],
       [ 569.9,  335.5,  618.3,  369.3],
       [ 817.4,  325.8,  871.2,  363.6],
       [ 569.9,  322. ,  638.6,  340.8],
       [ 725.7,  330.4,  774.8,  345.9],
       [ 526.6,  302.2,  572. ,  357.8]], dtype=float32), 'labels': array([1, 1, 1, 5, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 7, 5, 0, 3, 7, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 7]), 'bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'masks': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'seg_map': 'train/1997.png'}, 'img_prefix': '/opt/ml/detection/dataset/', 'seg_prefix': None, 'proposal_file': None, 'bbox_fields': ['gt_bboxes_ignore', 'gt_bboxes'], 'mask_fields': [], 'seg_fields': [], 'filename': '/opt/ml/detection/dataset/train/1997.jpg', 'ori_filename': 'train/1997.jpg', 'img': array([[[115, 105,  98],
        [134, 124, 117],
        [119, 109, 102],
        ...,
        [ 25,  87, 147],
        [ 25,  87, 147],
        [ 26,  88, 148]],
       [[111, 101,  94],
        [137, 127, 120],
        [131, 121, 114],
        ...,
        [ 25,  87, 147],
        [ 26,  88, 148],
        [ 26,  88, 148]],
       [[109,  99,  92],
        [132, 122, 115],
        [128, 118, 111],
        ...,
        [ 25,  87, 147],
        [ 26,  88, 148],
        [ 26,  88, 148]],
       ...,
       [[101, 106, 109],
        [115, 120, 123],
        [120, 125, 128],
        ...,
        [122, 145, 141],
        [124, 147, 143],
        [125, 148, 144]],
       [[137, 142, 145],
        [142, 147, 150],
        [126, 131, 134],
        ...,
        [109, 132, 128],
        [110, 133, 129],
        [110, 133, 129]],
       [[162, 167, 170],
        [156, 161, 164],
        [123, 128, 131],
        ...,
        [116, 139, 135],
        [118, 141, 137],
        [120, 143, 139]]], dtype=uint8), 'img_shape': (1024, 1024, 3), 'ori_shape': (1024, 1024, 3), 'img_fields': ['img'], 'gt_bboxes': array([[ 514. ,    0. ,  575.6,  151.9],
       [ 858.4,  232.4,  937.6,  266.4],
       [ 848.6,  127.7, 1023.7,  235.6],
       [ 601.1,  491.7,  844.2,  658.3],
       [ 785.6,    0. , 1023.7,  135.6],
       [ 697.9,   11.2,  786.3,   26.4],
       [ 695.2,    0. ,  802.9,   16.5],
       [ 464.6,  150.3,  904.8,  498.7],
       [ 450. ,    0. ,  963. ,  323.6],
       [ 536. ,   63.2,  885.1,  163. ],
       [ 574.6,   36.6,  779.8,   64.5],
       [ 898.7,  850.8,  994.5,  939.7],
       [ 866.5,  653. ,  968.4,  765. ],
       [   0. ,  484.6,  522.5,  849.6],
       [ 411.8,  574.5,  930.2,  965.4],
       [ 593.6,  676.8,  723.3,  833. ],
       [ 611.2,  702.2,  672.2,  832.5],
       [ 581.4,  737.5,  690.4,  829.4],
       [ 941.7,  870.3, 1023.6,  957.7],
       [ 194.7,  302. ,  403.3,  402.6],
       [ 557.4,   53.6,  845.6,  168.6],
       [ 614.9,  325.3,  651.1,  354.3],
       [ 627.8,  326.6,  738.9,  373.6],
       [ 729.7,  358.3,  856. ,  382.2],
       [ 775.8,  335.2,  836.4,  376.9],
       [ 736.5,  333.2,  785.9,  365.2],
       [ 569.9,  335.5,  618.3,  369.3],
       [ 817.4,  325.8,  871.2,  363.6],
       [ 569.9,  322. ,  638.6,  340.8],
       [ 725.7,  330.4,  774.8,  345.9],
       [ 526.6,  302.2,  572. ,  357.8]], dtype=float32), 'gt_bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'gt_labels': array([1, 1, 1, 5, 1, 1, 1, 1, 1, 1, 1, 7, 1, 1, 7, 5, 0, 3, 7, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 7])}{'img_info': {'file_name': 'train/4733.jpg', 'width': 1024, 'height': 1024, 'license': 0, 'date_captured': '2020-12-24 16:33:50', 'id': 4733, 'filename': 'train/4733.jpg'}, 'ann_info': {'bboxes': array([[ 530.6,    0. ,  978.6,  145. ],
       [ 835. ,    0. , 1023.6,  140.4],
       [ 463.9,   35.3,  655.6,  151.4],
       [ 728.7,   21.1, 1023.6,  408.1],
       [ 640. ,  298.2, 1023.7,  575.8],
       [ 705. ,  391.9,  882.1,  533.6],
       [ 624.4,  395.2,  699.6,  426.7],
       [ 323.7,  226.8,  586.8,  440.1],
       [ 545.9,  324.3,  657. ,  464.7],
       [ 495.7,  115.8,  819.8,  435. ],
       [ 404.7,  375.6, 1023.7,  594.8],
       [ 460.5,  123.9,  639. ,  241. ],
       [ 450.4,  148.6,  589.9,  321.8],
       [ 349.8,  351.5, 1023.7,  944. ],
       [ 355.9,  320.8,  481.5,  451.3],
       [   0. ,  692.8,  620. , 1023.7],
       [ 190.3,  835. ,  512. ,  898.2],
       [ 172.4,  702. ,  553. ,  927.8]], dtype=float32), 'labels': array([6, 1, 0, 1, 0, 5, 5, 1, 7, 1, 1, 1, 0, 1, 0, 7, 5, 0]), 'bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'masks': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'seg_map': 'train/4733.png'}, 'img_prefix': '/opt/ml/detection/dataset/', 'seg_prefix': None, 'proposal_file': None, 'bbox_fields': ['gt_bboxes_ignore', 'gt_bboxes'], 'mask_fields': [], 'seg_fields': [], 'filename': '/opt/ml/detection/dataset/train/4733.jpg', 'ori_filename': 'train/4733.jpg', 'img': array([[[106, 106, 106],
        [106, 106, 106],
        [106, 106, 106],
        ...,
        [140, 189, 203],
        [136, 188, 201],
        [136, 188, 201]],
       [[106, 106, 106],
        [106, 106, 106],
        [106, 106, 106],
        ...,
        [143, 192, 206],
        [140, 192, 205],
        [141, 193, 206]],
       [[106, 106, 106],
        [106, 106, 106],
        [106, 106, 106],
        ...,
        [138, 187, 201],
        [137, 189, 202],
        [138, 190, 203]],
       ...,
       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [231, 233, 233],
        [231, 233, 233],
        [230, 232, 232]],
       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [230, 232, 232],
        [230, 232, 232],
        [230, 232, 232]],
       [[255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        ...,
        [230, 232, 232],
        [230, 232, 232],
        [230, 232, 232]]], dtype=uint8), 'img_shape': (1024, 1024, 3), 'ori_shape': (1024, 1024, 3), 'img_fields': ['img'], 'gt_bboxes': array([[ 530.6,    0. ,  978.6,  145. ],
       [ 835. ,    0. , 1023.6,  140.4],
       [ 463.9,   35.3,  655.6,  151.4],
       [ 728.7,   21.1, 1023.6,  408.1],
       [ 640. ,  298.2, 1023.7,  575.8],
       [ 705. ,  391.9,  882.1,  533.6],
       [ 624.4,  395.2,  699.6,  426.7],
       [ 323.7,  226.8,  586.8,  440.1],
       [ 545.9,  324.3,  657. ,  464.7],
       [ 495.7,  115.8,  819.8,  435. ],
       [ 404.7,  375.6, 1023.7,  594.8],
       [ 460.5,  123.9,  639. ,  241. ],
       [ 450.4,  148.6,  589.9,  321.8],
       [ 349.8,  351.5, 1023.7,  944. ],
       [ 355.9,  320.8,  481.5,  451.3],
       [   0. ,  692.8,  620. , 1023.7],
       [ 190.3,  835. ,  512. ,  898.2],
       [ 172.4,  702. ,  553. ,  927.8]], dtype=float32), 'gt_bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'gt_labels': array([6, 1, 0, 1, 0, 5, 5, 1, 7, 1, 1, 1, 0, 1, 0, 7, 5, 0])}
> /opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py(2038)_mosaic_transform()
-> assert 'mix_results' in results
(Pdb)
> /opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py(2038)_mosaic_transform()
-> assert 'mix_results' in results
(Pdb)
{'img_info': {'file_name': 'train/3199.jpg', 'width': 1024, 'height': 1024, 'license': 0, 'date_captured': '2020-12-25 13:17:47', 'id': 3199, 'filename': 'train/3199.jpg'}, 'ann_info': {'bboxes': array([[323. , 386. , 657.2, 580. ]], dtype=float32), 'labels': array([0]), 'bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'masks': [None], 'seg_map': 'train/3199.png'}, 'img_prefix': '/opt/ml/detection/dataset/', 'seg_prefix': None, 'proposal_file': None, 'bbox_fields': ['gt_bboxes_ignore', 'gt_bboxes'], 'mask_fields': [], 'seg_fields': [], 'filename': '/opt/ml/detection/dataset/train/3199.jpg', 'ori_filename': 'train/3199.jpg', 'img': array([[[156, 168, 168],
        [161, 173, 173],
        [166, 178, 178],
        ...,
        [100, 127, 153],
        [120, 150, 177],
        [147, 179, 208]],
       [[165, 177, 177],
        [167, 179, 179],
        [168, 180, 180],
        ...,
        [111, 138, 164],
        [133, 163, 190],
        [149, 181, 210]],
       [[160, 172, 172],
        [160, 172, 172],
        [160, 172, 172],
        ...,
        [116, 143, 169],
        [136, 166, 193],
        [137, 169, 198]],
       ...,
       [[104, 106, 100],
        [115, 117, 111],
        [122, 124, 118],
        ...,
        [204, 216, 218],
        [197, 209, 211],
        [187, 199, 201]],
       [[ 93,  96,  87],
        [106, 109, 100],
        [114, 117, 108],
        ...,
        [198, 210, 212],
        [194, 206, 208],
        [190, 202, 204]],
       [[ 98, 102,  91],
        [113, 117, 106],
        [123, 126, 117],
        ...,
        [192, 204, 206],
        [194, 206, 208],
        [195, 207, 209]]], dtype=uint8), 'img_shape': (1024, 1024, 3), 'ori_shape': (1024, 1024, 3), 'img_fields': ['img'], 'gt_bboxes': array([[323. , 386. , 657.2, 580. ]], dtype=float32), 'gt_bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'gt_labels': array([0])}
> /opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py(2038)_mosaic_transform()
-> assert 'mix_results' in results
(Pdb)
{'img_info': {'file_name': 'train/4311.jpg', 'width': 1024, 'height': 1024, 'license': 0, 'date_captured': '2020-12-28 14:45:26', 'id': 4311, 'filename': 'train/4311.jpg'}, 'ann_info': {'bboxes': array([[407.1, 258.2, 801.2, 768.6]], dtype=float32), 'labels': array([0]), 'bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'masks': [None], 'seg_map': 'train/4311.png'}, 'img_prefix': '/opt/ml/detection/dataset/', 'seg_prefix': None, 'proposal_file': None, 'bbox_fields': ['gt_bboxes_ignore', 'gt_bboxes'], 'mask_fields': [], 'seg_fields': [], 'filename': '/opt/ml/detection/dataset/train/4311.jpg', 'ori_filename': 'train/4311.jpg', 'img': array([[[112, 116, 121],
        [113, 117, 122],
        [113, 117, 122],
        ...,
        [106, 106, 106],
        [117, 117, 117],
        [117, 117, 117]],
       [[116, 120, 125],
        [119, 123, 128],
        [119, 123, 128],
        ...,
        [ 99,  99,  99],
        [107, 107, 107],
        [105, 105, 105]],
       [[105, 108, 112],
        [110, 113, 117],
        [110, 113, 117],
        ...,
        [101, 101, 101],
        [113, 113, 113],
        [115, 115, 115]],
       ...,
       [[ 96,  99, 103],
        [ 82,  85,  89],
        [ 93,  96, 100],
        ...,
        [109, 111, 112],
        [111, 113, 114],
        [122, 124, 125]],
       [[ 93,  96, 100],
        [ 76,  79,  83],
        [ 74,  77,  81],
        ...,
        [107, 109, 110],
        [ 87,  89,  90],
        [136, 138, 139]],
       [[ 86,  89,  93],
        [ 84,  87,  91],
        [ 77,  80,  84],
        ...,
        [118, 120, 121],
        [127, 129, 130],
        [123, 125, 126]]], dtype=uint8), 'img_shape': (1024, 1024, 3), 'ori_shape': (1024, 1024, 3), 'img_fields': ['img'], 'gt_bboxes': array([[407.1, 258.2, 801.2, 768.6]], dtype=float32), 'gt_bboxes_ignore': array([], shape=(0, 4), dtype=float32), 'gt_labels': array([0])}
> /opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py(2038)_mosaic_transform()
-> assert 'mix_results' in results
(Pdb)
Traceback (most recent call last):
  File "tools/train.py", line 189, in <module>
    main()
  File "tools/train.py", line 185, in main
    meta=meta)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/apis/train.py", line 174, in train_detector
    runner.run(data_loaders, cfg.workflow)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 127, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 47, in train
    for i, data_batch in enumerate(self.data_loader):
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 435, in __next__
    data = self._next_data()
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1085, in _next_data
    return self._process_data(data)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1111, in _process_data
    data.reraise()
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/_utils.py", line 428, in reraise
    raise self.exc_type(msg)
bdb.BdbQuit: Caught BdbQuit in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 198, in _worker_loop
    data = fetcher.fetch(index)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/custom.py", line 195, in __getitem__
    data = self.prepare_train_img(idx)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/custom.py", line 218, in prepare_train_img
    return self.pipeline(results)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/compose.py", line 41, in __call__
    data = t(data)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py", line 2012, in __call__
    results = self._mosaic_transform(results)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py", line 2038, in _mosaic_transform
    assert 'mix_results' in results
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/datasets/pipelines/transforms.py", line 2038, in _mosaic_transform
    assert 'mix_results' in results
  File "/opt/conda/envs/detection/lib/python3.7/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/opt/conda/envs/detection/lib/python3.7/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit