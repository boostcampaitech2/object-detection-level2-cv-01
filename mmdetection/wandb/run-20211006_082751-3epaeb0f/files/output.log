/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/core/anchor/anchor_generator.py:324: UserWarning: ``grid_anchors`` would be deprecated soon. Please use ``grid_priors``
  warnings.warn('``grid_anchors`` would be deprecated soon. '
/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/core/anchor/anchor_generator.py:361: UserWarning: ``single_level_grid_anchors`` would be deprecated soon. Please use ``single_level_grid_priors``
  '``single_level_grid_anchors`` would be deprecated soon. '
2021-10-06 08:28:17,269 - mmdet - INFO - Epoch [1][50/1109]	lr: 5.851e-06, eta: 5:53:10, time: 0.382, data_time: 0.049, memory: 2702, loss_rpn_cls: 0.6317, loss_rpn_bbox: 0.0476, s0.loss_cls: 1.4570, s0.acc: 68.3271, s0.loss_bbox: 0.2002, s1.loss_cls: 0.8478, s1.acc: 64.2490, s1.loss_bbox: 0.0446, s2.loss_cls: 0.0606, s2.acc: 94.6602, s2.loss_bbox: 0.0112, loss: 3.3007
2021-10-06 08:28:33,878 - mmdet - INFO - Epoch [1][100/1109]	lr: 1.080e-05, eta: 5:29:38, time: 0.332, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.4627, loss_rpn_bbox: 0.0383, s0.loss_cls: 0.3227, s0.acc: 94.4590, s0.loss_bbox: 0.1575, s1.loss_cls: 0.0913, s1.acc: 97.6387, s1.loss_bbox: 0.0399, s2.loss_cls: 0.0269, s2.acc: 98.6631, s2.loss_bbox: 0.0079, loss: 1.1472
2021-10-06 08:28:50,456 - mmdet - INFO - Epoch [1][150/1109]	lr: 1.575e-05, eta: 5:21:25, time: 0.332, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.2646, loss_rpn_bbox: 0.0349, s0.loss_cls: 0.3135, s0.acc: 93.9609, s0.loss_bbox: 0.1636, s1.loss_cls: 0.0920, s1.acc: 97.2168, s1.loss_bbox: 0.0488, s2.loss_cls: 0.0275, s2.acc: 98.5391, s2.loss_bbox: 0.0093, loss: 0.9543
2021-10-06 08:29:06,858 - mmdet - INFO - Epoch [1][200/1109]	lr: 2.070e-05, eta: 5:16:21, time: 0.328, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.2229, loss_rpn_bbox: 0.0412, s0.loss_cls: 0.2948, s0.acc: 93.7344, s0.loss_bbox: 0.1561, s1.loss_cls: 0.0932, s1.acc: 96.8994, s1.loss_bbox: 0.0503, s2.loss_cls: 0.0292, s2.acc: 98.2627, s2.loss_bbox: 0.0099, loss: 0.8977
2021-10-06 08:29:23,261 - mmdet - INFO - Epoch [1][250/1109]	lr: 2.565e-05, eta: 5:13:13, time: 0.328, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1796, loss_rpn_bbox: 0.0338, s0.loss_cls: 0.2815, s0.acc: 94.1133, s0.loss_bbox: 0.1384, s1.loss_cls: 0.0867, s1.acc: 96.9893, s1.loss_bbox: 0.0515, s2.loss_cls: 0.0262, s2.acc: 98.4600, s2.loss_bbox: 0.0101, loss: 0.8079
2021-10-06 08:29:40,463 - mmdet - INFO - Epoch [1][300/1109]	lr: 3.060e-05, eta: 5:13:29, time: 0.344, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1801, loss_rpn_bbox: 0.0342, s0.loss_cls: 0.3098, s0.acc: 93.2783, s0.loss_bbox: 0.1586, s1.loss_cls: 0.0972, s1.acc: 96.4023, s1.loss_bbox: 0.0610, s2.loss_cls: 0.0305, s2.acc: 98.1172, s2.loss_bbox: 0.0129, loss: 0.8843
2021-10-06 08:29:56,914 - mmdet - INFO - Epoch [1][350/1109]	lr: 3.555e-05, eta: 5:11:37, time: 0.329, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1655, loss_rpn_bbox: 0.0296, s0.loss_cls: 0.2762, s0.acc: 93.8135, s0.loss_bbox: 0.1380, s1.loss_cls: 0.0958, s1.acc: 96.2334, s1.loss_bbox: 0.0633, s2.loss_cls: 0.0310, s2.acc: 97.9658, s2.loss_bbox: 0.0140, loss: 0.8134
2021-10-06 08:30:13,289 - mmdet - INFO - Epoch [1][400/1109]	lr: 4.050e-05, eta: 5:09:58, time: 0.327, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1568, loss_rpn_bbox: 0.0330, s0.loss_cls: 0.2806, s0.acc: 93.5742, s0.loss_bbox: 0.1470, s1.loss_cls: 0.1007, s1.acc: 95.6152, s1.loss_bbox: 0.0711, s2.loss_cls: 0.0340, s2.acc: 97.5781, s2.loss_bbox: 0.0186, loss: 0.8420
2021-10-06 08:30:30,009 - mmdet - INFO - Epoch [1][450/1109]	lr: 4.545e-05, eta: 5:09:20, time: 0.334, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1466, loss_rpn_bbox: 0.0298, s0.loss_cls: 0.3136, s0.acc: 92.6494, s0.loss_bbox: 0.1573, s1.loss_cls: 0.1202, s1.acc: 94.9697, s1.loss_bbox: 0.0825, s2.loss_cls: 0.0414, s2.acc: 96.9941, s2.loss_bbox: 0.0247, loss: 0.9162
2021-10-06 08:30:46,546 - mmdet - INFO - Epoch [1][500/1109]	lr: 5.040e-05, eta: 5:08:26, time: 0.331, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1245, loss_rpn_bbox: 0.0268, s0.loss_cls: 0.2685, s0.acc: 93.5420, s0.loss_bbox: 0.1354, s1.loss_cls: 0.1106, s1.acc: 95.0527, s1.loss_bbox: 0.0782, s2.loss_cls: 0.0407, s2.acc: 96.7363, s2.loss_bbox: 0.0261, loss: 0.8108
2021-10-06 08:31:03,176 - mmdet - INFO - Epoch [1][550/1109]	lr: 5.535e-05, eta: 5:07:49, time: 0.333, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1162, loss_rpn_bbox: 0.0256, s0.loss_cls: 0.3026, s0.acc: 93.0137, s0.loss_bbox: 0.1481, s1.loss_cls: 0.1201, s1.acc: 94.6260, s1.loss_bbox: 0.0889, s2.loss_cls: 0.0430, s2.acc: 96.5898, s2.loss_bbox: 0.0288, loss: 0.8733
2021-10-06 08:31:19,621 - mmdet - INFO - Epoch [1][600/1109]	lr: 6.030e-05, eta: 5:06:57, time: 0.329, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1251, loss_rpn_bbox: 0.0273, s0.loss_cls: 0.3083, s0.acc: 92.4355, s0.loss_bbox: 0.1463, s1.loss_cls: 0.1282, s1.acc: 93.7832, s1.loss_bbox: 0.0961, s2.loss_cls: 0.0480, s2.acc: 95.8047, s2.loss_bbox: 0.0351, loss: 0.9143
2021-10-06 08:31:36,051 - mmdet - INFO - Epoch [1][650/1109]	lr: 6.525e-05, eta: 5:06:10, time: 0.329, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1449, loss_rpn_bbox: 0.0350, s0.loss_cls: 0.3684, s0.acc: 90.9658, s0.loss_bbox: 0.1825, s1.loss_cls: 0.1539, s1.acc: 92.8281, s1.loss_bbox: 0.1131, s2.loss_cls: 0.0583, s2.acc: 95.1904, s2.loss_bbox: 0.0380, loss: 1.0942
2021-10-06 08:31:52,594 - mmdet - INFO - Epoch [1][700/1109]	lr: 7.020e-05, eta: 5:05:36, time: 0.331, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1221, loss_rpn_bbox: 0.0292, s0.loss_cls: 0.3410, s0.acc: 91.8945, s0.loss_bbox: 0.1623, s1.loss_cls: 0.1379, s1.acc: 93.5996, s1.loss_bbox: 0.1007, s2.loss_cls: 0.0506, s2.acc: 95.7988, s2.loss_bbox: 0.0342, loss: 0.9782
2021-10-06 08:32:09,030 - mmdet - INFO - Epoch [1][750/1109]	lr: 7.515e-05, eta: 5:04:57, time: 0.329, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1273, loss_rpn_bbox: 0.0310, s0.loss_cls: 0.3543, s0.acc: 91.0166, s0.loss_bbox: 0.1721, s1.loss_cls: 0.1518, s1.acc: 92.3096, s1.loss_bbox: 0.1187, s2.loss_cls: 0.0591, s2.acc: 94.6523, s2.loss_bbox: 0.0431, loss: 1.0575
2021-10-06 08:32:25,527 - mmdet - INFO - Epoch [1][800/1109]	lr: 8.010e-05, eta: 5:04:25, time: 0.330, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1184, loss_rpn_bbox: 0.0282, s0.loss_cls: 0.3310, s0.acc: 92.1514, s0.loss_bbox: 0.1532, s1.loss_cls: 0.1390, s1.acc: 93.5439, s1.loss_bbox: 0.1028, s2.loss_cls: 0.0527, s2.acc: 95.8555, s2.loss_bbox: 0.0335, loss: 0.9590
2021-10-06 08:32:42,046 - mmdet - INFO - Epoch [1][850/1109]	lr: 8.505e-05, eta: 5:03:55, time: 0.330, data_time: 0.005, memory: 2702, loss_rpn_cls: 0.1363, loss_rpn_bbox: 0.0311, s0.loss_cls: 0.3745, s0.acc: 91.2520, s0.loss_bbox: 0.1714, s1.loss_cls: 0.1528, s1.acc: 92.9531, s1.loss_bbox: 0.1085, s2.loss_cls: 0.0561, s2.acc: 95.4229, s2.loss_bbox: 0.0367, loss: 1.0675
2021-10-06 08:32:58,918 - mmdet - INFO - Epoch [1][900/1109]	lr: 9.000e-05, eta: 5:03:49, time: 0.337, data_time: 0.006, memory: 2702, loss_rpn_cls: 0.1293, loss_rpn_bbox: 0.0262, s0.loss_cls: 0.3335, s0.acc: 92.1592, s0.loss_bbox: 0.1471, s1.loss_cls: 0.1418, s1.acc: 93.4746, s1.loss_bbox: 0.1000, s2.loss_cls: 0.0547, s2.acc: 95.5791, s2.loss_bbox: 0.0357, loss: 0.9683
2021-10-06 08:33:15,553 - mmdet - INFO - Epoch [1][950/1109]	lr: 9.495e-05, eta: 5:03:28, time: 0.333, data_time: 0.006, memory: 2702, loss_rpn_cls: 0.1490, loss_rpn_bbox: 0.0374, s0.loss_cls: 0.3989, s0.acc: 90.6826, s0.loss_bbox: 0.1795, s1.loss_cls: 0.1618, s1.acc: 92.5322, s1.loss_bbox: 0.1156, s2.loss_cls: 0.0593, s2.acc: 95.1855, s2.loss_bbox: 0.0387, loss: 1.1401
2021-10-06 08:33:32,296 - mmdet - INFO - Exp name: Swint_Test.py
2021-10-06 08:33:32,296 - mmdet - INFO - Epoch [1][1000/1109]	lr: 9.990e-05, eta: 5:03:14, time: 0.335, data_time: 0.006, memory: 2702, loss_rpn_cls: 0.1512, loss_rpn_bbox: 0.0349, s0.loss_cls: 0.3557, s0.acc: 92.0654, s0.loss_bbox: 0.1596, s1.loss_cls: 0.1354, s1.acc: 94.0693, s1.loss_bbox: 0.0909, s2.loss_cls: 0.0495, s2.acc: 96.2500, s2.loss_bbox: 0.0293, loss: 1.0064
2021-10-06 08:33:50,719 - mmdet - INFO - Epoch [1][1050/1109]	lr: 1.000e-04, eta: 5:04:26, time: 0.368, data_time: 0.007, memory: 2702, loss_rpn_cls: 0.1284, loss_rpn_bbox: 0.0248, s0.loss_cls: 0.3299, s0.acc: 92.5859, s0.loss_bbox: 0.1415, s1.loss_cls: 0.1325, s1.acc: 94.2236, s1.loss_bbox: 0.0900, s2.loss_cls: 0.0470, s2.acc: 96.3613, s2.loss_bbox: 0.0287, loss: 0.9227
2021-10-06 08:34:09,047 - mmdet - INFO - Epoch [1][1100/1109]	lr: 1.000e-04, eta: 5:05:25, time: 0.367, data_time: 0.007, memory: 2702, loss_rpn_cls: 0.1718, loss_rpn_bbox: 0.0358, s0.loss_cls: 0.3991, s0.acc: 91.3506, s0.loss_bbox: 0.1756, s1.loss_cls: 0.1501, s1.acc: 93.7939, s1.loss_bbox: 0.0999, s2.loss_cls: 0.0520, s2.acc: 96.3486, s2.loss_bbox: 0.0287, loss: 1.1130
2021-10-06 08:34:12,444 - mmdet - INFO - Saving checkpoint at 1 epochs













[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>] 448/448, 16.1 task/s, elapsed: 28s, ETA:     0sLoading and preparing results...
DONE (t=0.00s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=0.52s).
Accumulating evaluation results...
DONE (t=0.13s).
Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.003
Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.007
Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.002
Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.000
Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.000
Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.004
Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.015
Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.015
Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.015
Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.000
Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.000
Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.019
2021-10-06 08:34:43,084 - mmdet - INFO - Evaluating bbox...
2021-10-06 08:34:45,935 - mmdet - INFO - Now best checkpoint is saved as best_bbox_mAP_50_epoch_1.pth.
2021-10-06 08:34:45,935 - mmdet - INFO - Best bbox_mAP_50 is 0.0070 at 1 epoch.
2021-10-06 08:34:45,937 - mmdet - INFO - Exp name: Swint_Test.py
2021-10-06 08:34:45,937 - mmdet - INFO - Epoch(val) [1][448]	bbox_mAP: 0.0030, bbox_mAP_50: 0.0070, bbox_mAP_75: 0.0020, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.003 0.007 0.002 0.000 0.000 0.004
Traceback (most recent call last):
  File "tools/train.py", line 188, in <module>
    main()
  File "tools/train.py", line 184, in main
    meta=meta)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/apis/train.py", line 174, in train_detector
    runner.run(data_loaders, cfg.workflow)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 127, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 50, in train
    self.run_iter(data_batch, train_mode=True, **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/epoch_based_runner.py", line 30, in run_iter
    **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/parallel/data_parallel.py", line 67, in train_step
    return self.module.train_step(*inputs[0], **kwargs[0])
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/detectors/base.py", line 238, in train_step
    losses = self(**data)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/fp16_utils.py", line 98, in new_func
    return old_func(*args, **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/detectors/base.py", line 172, in forward
    return self.forward_train(img, img_metas, **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/detectors/two_stage.py", line 141, in forward_train
    proposal_cfg=proposal_cfg)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/dense_heads/base_dense_head.py", line 55, in forward_train
    losses = self.loss(*loss_inputs, gt_bboxes_ignore=gt_bboxes_ignore)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/dense_heads/rpn_head.py", line 98, in loss
    gt_bboxes_ignore=gt_bboxes_ignore)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmcv/runner/fp16_utils.py", line 186, in new_func
    return old_func(*args, **kwargs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/dense_heads/anchor_head.py", line 464, in loss
    label_channels=label_channels)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/dense_heads/anchor_head.py", line 346, in get_targets
    unmap_outputs=unmap_outputs)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/core/utils/misc.py", line 30, in multi_apply
    return tuple(map(list, zip(*map_results)))
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/models/dense_heads/anchor_head.py", line 220, in _get_targets_single
    None if self.sampling else gt_labels)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/core/bbox/assigners/max_iou_assigner.py", line 120, in assign
    assign_result = self.assign_wrt_overlaps(overlaps, gt_labels)
  File "/opt/conda/envs/detection/lib/python3.7/site-packages/mmdet/core/bbox/assigners/max_iou_assigner.py", line 197, in assign_wrt_overlaps
    max_iou_inds = overlaps[i, :] == gt_max_overlaps[i]
KeyboardInterrupt